test_that("normal input", {
  expect_equal(r(58,3.86), dpois(58, 3.86))
  expect_equal(r(4,4), dpois(4,4))
  expect_equal(r(1234567,1234567), dpois(1234567,1234567))
  expect_equal(r(12,1234567), dpois(12,1234567))
  expect_equal(r(1234568,1234567), dpois(1234568,1234567))
})

test_that("erroneous input", {
  expect_equal(r(4.1, 4), dpois(4.1, 4))
  expect_equal(r(-4, 4), dpois(-4, 4))
  expect_equal(r(4, -4), dpois(4, -4))
  expect_equal(r(0, 4), dpois(0, 4))
  expect_equal(r(4, 0), dpois(4, 0))
  expect_equal(r(0, 0), dpois(0, 0))
})

test_that("range & small values of x", {
  expect_equal(r(1:5, 4),dpois(1:5, 4))
  expect_equal(r(5, 5:10),dpois(5, 5:10))
  expect_equal(r(3, 400),dpois(3, 400))
  expect_equal(r(4, 400),dpois(4, 400))
  expect_equal(r(3, 1),dpois(3, 1))
  expect_equal(r(4, 1),dpois(4, 1))
  expect_equal(r(5, 5),dpois(5, 5))
})

test_that("vectorization", {
  expect_equal(r(c(-1,0,1,1000000), 5), dpois(c(-1,0,1,1000000), 5))
  expect_equal(r(c(-1,0,1,1000000), 4:5), dpois(c(-1,0,1,1000000), 4:5))
})

test_that("logs", {
  expect_equal(r(58,3.86,T), dpois(58, 3.86,T))
  expect_equal(r(4, 4,T), dpois(4, 4,T))
  expect_equal(r(1234567,1234567,T), dpois(1234567,1234567,T))
  expect_equal(r(12,1234567,T), dpois(12,1234567,T))
  expect_equal(r(1234568,1234567,T), dpois(1234568,1234567,T))
  expect_equal(r(4.1, 4,T), dpois(4.1, 4,T))
  expect_equal(r(-4, 4,T), dpois(-4, 4,T))
  expect_equal(r(4, -4,T), dpois(4, -4,T))
  expect_equal(r(0, 4,T), dpois(0, 4,T))
  expect_equal(r(4, 0,T), dpois(4, 0,T))
  expect_equal(r(0, 0,T), dpois(0, 0,T))
  expect_equal(r(1:5, 4,T), dpois(1:5, 4,T))
  expect_equal(r(5, 5:10,T), dpois(5, 5:10,T))
  expect_equal(r(3, 400,T), dpois(3, 400,T))
  expect_equal(r(4, 400,T), dpois(4, 400,T))
  expect_equal(r(3, 1,T), dpois(3, 1,T))
  expect_equal(r(4, 1,T), dpois(4, 1,T))
  expect_equal(r(5, 5,T), dpois(5, 5,T))
  expect_equal(r(c(-1,0,1,1000000,T), 5,T), dpois(c(-1,0,1,1000000,T), 5,T))
  expect_equal(r(c(-1,0,1,1000000,T), 4:5,T), dpois(c(-1,0,1,1000000,T), 4:5,T))
  expect_equal(r(5, 5,"abc"), dpois(5, 5,"abc"))
})
