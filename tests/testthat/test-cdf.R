test_that("normal input", {
  expect_equal(cdf(10,10), ppois(10,10))
  expect_equal(cdf(58,3.86), ppois(58, 3.86))
  expect_equal(cdf(4,4), ppois(4, 4))
  expect_equal(cdf(1234567,1234567), ppois(1234567,1234567))
  expect_equal(cdf(12,1234567), ppois(12,1234567))
  expect_equal(cdf(1234568,1234567), ppois(1234568,1234567))
  expect_equal(cdf(0, 4), ppois(0, 4))
  expect_equal(cdf(4, 0), ppois(4, 0))
  expect_equal(cdf(0, 0), ppois(0, 0))
  expect_equal(cdf(1:5, 4), ppois(1:5, 4))
  expect_equal(cdf(5, 5:10), ppois(5, 5:10))
  expect_equal(cdf(3, 400), ppois(3, 400))
  expect_equal(cdf(4, 400), ppois(4, 400))
  expect_equal(cdf(3, 1), ppois(3, 1))
  expect_equal(cdf(4, 1), ppois(4, 1))
  expect_equal(cdf(5, 5), ppois(5, 5))
  expect_equal(cdf(c(-1,0,1,1000000), 5), ppois(c(-1,0,1,1000000), 5))
  expect_equal(cdf(c(-1,0,1,1000000), 4:5), ppois(c(-1,0,1,1000000), 4:5))
})

test_that("decimal x", {
  expect_equal(cdf(10.1,10), ppois(10.1,10))
  expect_equal(cdf(4.1, 4), ppois(4.1, 4))
})

test_that("negative lamb", {
  expect_equal(cdf(-4, 4), ppois(-4, 4))
  expect_equal(cdf(4, -4), ppois(4, -4))
})

test_that("log", {
  expect_equal(cdf(10,10, log.p = TRUE), ppois(10,10, log.p = TRUE))
  expect_equal(cdf(10.1,10, log.p = TRUE), ppois(10.1,10, log.p = TRUE))
  expect_equal(cdf(58,3.86, log.p = TRUE), ppois(58, 3.86, log.p = TRUE))
  expect_equal(cdf(4,4, log.p = TRUE), ppois(4, 4, log.p = TRUE))
  expect_equal(cdf(1234567,1234567, log.p = TRUE), ppois(1234567,1234567, log.p = TRUE))
  expect_equal(cdf(12,1234567, log.p = TRUE), ppois(12,1234567, log.p = TRUE))
  expect_equal(cdf(1234568,1234567, log.p = TRUE), ppois(1234568,1234567, log.p = TRUE))
  expect_equal(cdf(4.1, 4, log.p = TRUE), ppois(4.1, 4, log.p = TRUE))
  expect_equal(cdf(-4, 4, log.p = TRUE), ppois(-4, 4, log.p = TRUE))
  expect_equal(cdf(4, -4, log.p = TRUE), ppois(4, -4, log.p = TRUE))
  expect_equal(cdf(0, 4, log.p = TRUE), ppois(0, 4, log.p = TRUE))
  expect_equal(cdf(4, 0, log.p = TRUE), ppois(4, 0, log.p = TRUE))
  expect_equal(cdf(0, 0, log.p = TRUE), ppois(0, 0, log.p = TRUE))
  expect_equal(cdf(1:5, 4, log.p = TRUE), ppois(1:5, 4, log.p = TRUE))
  expect_equal(cdf(5, 5:10, log.p = TRUE), ppois(5, 5:10, log.p = TRUE))
  expect_equal(cdf(3, 400, log.p = TRUE), ppois(3, 400, log.p = TRUE))
  expect_equal(cdf(4, 400, log.p = TRUE), ppois(4, 400, log.p = TRUE))
  expect_equal(cdf(3, 1, log.p = TRUE), ppois(3, 1, log.p = TRUE))
  expect_equal(cdf(4, 1, log.p = TRUE), ppois(4, 1, log.p = TRUE))
  expect_equal(cdf(5, 5, log.p = TRUE), ppois(5, 5, log.p = TRUE))
  expect_equal(cdf(c(-1,0,1,1000000), 5, log.p = TRUE), ppois(c(-1,0,1,1000000), 5, log.p = TRUE))
  expect_equal(cdf(c(-1,0,1,1000000), 4:5, log.p = TRUE), ppois(c(-1,0,1,1000000), 4:5, log.p = TRUE))
})

test_that("upper tail", {
  expect_equal(cdf(10,10, lower.tail = FALSE), ppois(10,10, lower.tail = FALSE))
  expect_equal(cdf(10.1,10, lower.tail = FALSE), ppois(10.1,10, lower.tail = FALSE))
  expect_equal(cdf(58,3.86, lower.tail = FALSE), ppois(58, 3.86, lower.tail = FALSE))
  expect_equal(cdf(4,4, lower.tail = FALSE), ppois(4, 4, lower.tail = FALSE))
  expect_equal(cdf(1234567,1234567, lower.tail = FALSE), ppois(1234567,1234567, lower.tail = FALSE))
  expect_equal(cdf(12,1234567, lower.tail = FALSE), ppois(12,1234567, lower.tail = FALSE))
  expect_equal(cdf(1234568,1234567, lower.tail = FALSE), ppois(1234568,1234567, lower.tail = FALSE))
  expect_equal(cdf(4.1, 4, lower.tail = FALSE), ppois(4.1, 4, lower.tail = FALSE))
  expect_equal(cdf(-4, 4, lower.tail = FALSE), ppois(-4, 4, lower.tail = FALSE))
  expect_equal(cdf(-10.1, 4, lower.tail = FALSE), ppois(-10.1, 4, lower.tail = FALSE))
  expect_equal(cdf(4, -4, lower.tail = FALSE), ppois(4, -4, lower.tail = FALSE))
  expect_equal(cdf(0, 4, lower.tail = FALSE), ppois(0, 4, lower.tail = FALSE))
  expect_equal(cdf(4, 0, lower.tail = FALSE), ppois(4, 0, lower.tail = FALSE))
  expect_equal(cdf(0, 0, lower.tail = FALSE), ppois(0, 0, lower.tail = FALSE))
  expect_equal(cdf(1:5, 4, lower.tail = FALSE), ppois(1:5, 4, lower.tail = FALSE))
  expect_equal(cdf(5, 5:10, lower.tail = FALSE), ppois(5, 5:10, lower.tail = FALSE))
  expect_equal(cdf(3, 400, lower.tail = FALSE), ppois(3, 400, lower.tail = FALSE))
  expect_equal(cdf(4, 400, lower.tail = FALSE), ppois(4, 400, lower.tail = FALSE))
  expect_equal(cdf(3, 1, lower.tail = FALSE), ppois(3, 1, lower.tail = FALSE))
  expect_equal(cdf(4, 1, lower.tail = FALSE), ppois(4, 1, lower.tail = FALSE))
  expect_equal(cdf(5, 5, lower.tail = FALSE), ppois(5, 5, lower.tail = FALSE))
  expect_equal(cdf(c(-1,0,1,1000000), 5, lower.tail = FALSE), ppois(c(-1,0,1,1000000), 5, lower.tail = FALSE))
  expect_equal(cdf(c(-1,0,1,1000000), 4:5, lower.tail = FALSE), ppois(c(-1,0,1,1000000), 4:5, lower.tail = FALSE))
})
test_that("log && upper tail", {
  expect_equal(cdf(10,10, lower.tail = FALSE, log.p = TRUE), ppois(10,10, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(10.1,10, lower.tail = FALSE, log.p = TRUE), ppois(10.1,10, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(58,3.86, lower.tail = FALSE, log.p = TRUE), ppois(58, 3.86, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4,4, lower.tail = FALSE, log.p = TRUE), ppois(4, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(1234567,1234567, lower.tail = FALSE, log.p = TRUE), ppois(1234567,1234567, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(12,1234567, lower.tail = FALSE, log.p = TRUE), ppois(12,1234567, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(1234568,1234567, lower.tail = FALSE, log.p = TRUE), ppois(1234568,1234567, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4.1, 4, lower.tail = FALSE, log.p = TRUE), ppois(4.1, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(-4, 4, lower.tail = FALSE, log.p = TRUE), ppois(-4, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(-10.1, 4, lower.tail = FALSE, log.p = TRUE), ppois(-10.1, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4, -4, lower.tail = FALSE, log.p = TRUE), ppois(4, -4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(0, 4, lower.tail = FALSE, log.p = TRUE), ppois(0, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4, 0, lower.tail = FALSE, log.p = TRUE), ppois(4, 0, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(0, 0, lower.tail = FALSE, log.p = TRUE), ppois(0, 0, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(1:5, 4, lower.tail = FALSE, log.p = TRUE), ppois(1:5, 4, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(5, 5:10, lower.tail = FALSE, log.p = TRUE), ppois(5, 5:10, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(3, 400, lower.tail = FALSE, log.p = TRUE), ppois(3, 400, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4, 400, lower.tail = FALSE, log.p = TRUE), ppois(4, 400, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(3, 1, lower.tail = FALSE, log.p = TRUE), ppois(3, 1, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(4, 1, lower.tail = FALSE, log.p = TRUE), ppois(4, 1, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(5, 5, lower.tail = FALSE, log.p = TRUE), ppois(5, 5, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(c(-1,0,1,1000000), 5, lower.tail = FALSE, log.p = TRUE), ppois(c(-1,0,1,1000000), 5, lower.tail = FALSE, log.p = TRUE))
  expect_equal(cdf(c(-1,0,1,1000000), 4:5, lower.tail = FALSE, log.p = TRUE), ppois(c(-1,0,1,1000000), 4:5, lower.tail = FALSE, log.p = TRUE))
})


